@model List<juezprueba.Models.Problema>

@{
    ViewBag.Title = "Lista de Problemas";
}

<div class="container-fluid py-4">
    <div class="card shadow-lg">
        <div class="card-header bg-purple text-white">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="h4 mb-0"><i class="fas fa-list-check me-2"></i>Lista de Problemas</h2>
                @if (User.IsInRole("Admin"))
                {
                    <a class="btn btn-light btn-sm" asp-action="Create">
                        <i class="fas fa-plus-circle me-1"></i> Nuevo Problema
                    </a>
                }

            </div>
        </div>

        <div class="card-body">
            @if (Model.Any())
            {
                <div class="table-responsive">
                    <table class="table table-hover">
                        <tbody>
                            @foreach (var problema in Model)
                            {
                                <tr class="align-middle">
                                    <td class="fw-bold fs-5">@problema.Titulo</td>
                                    <td class="text-end">
                                        <div class="btn-group" role="group">
                                            <a class="btn btn-sm btn-success" asp-action="Resolver" asp-route-id="@problema.Id">
                                                <i class="fas fa-code me-1"></i>Resolver
                                            </a>
                                            @if (User.IsInRole("Admin"))
                                            {
                                                <a class="btn btn-sm btn-sky-blue"
                                                href="@Url.Action("CasosDePruebaPorProblema", "CasoDePrueba", new { id = problema.Id })">
                                                    <i class="fas fa-vial me-1"></i>Pruebas
                                                </a>
                                                <a class="btn btn-sm btn-indigo" asp-action="Details" asp-route-id="@problema.Id">
                                                    <i class="fas fa-eye me-1"></i>Detalles
                                                </a>
                                                <a class="btn btn-sm btn-warning" asp-action="Edit" asp-route-id="@problema.Id">
                                                    <i class="fas fa-edit me-1"></i>Editar
                                                </a>
                                                <a class="btn btn-sm btn-danger" asp-action="Delete" asp-route-id="@problema.Id">
                                                    <i class="fas fa-trash-alt me-1"></i>Eliminar
                                                </a>
                                            }
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="alert alert-purple text-center">
                    <i class="fas fa-info-circle fa-2x mb-3"></i>
                    <h4 class="alert-heading">No hay problemas registrados</h4>
                    <p>Comienza creando tu primer problema haciendo clic en el botón "Nuevo Problema".</p>
                </div>
            }
        </div>

        @if (Model.Any())
        {
            <div class="card-footer bg-body-secondary">
                <small class="text-muted">Mostrando @Model.Count problema(s) en total</small>
            </div>
        }
    </div>
</div>

@section Styles {
    <style>
        :root {
            /* Colores principales */
            --bs-purple: #6f42c1;
            --bs-indigo: #6610f2;
            --bs-sky-blue: #0dcaf0;
            /* RGB para cálculos */
            --bs-purple-rgb: 111, 66, 193;
            --bs-indigo-rgb: 102, 16, 242;
            --bs-sky-blue-rgb: 13, 202, 240;
        }

        /* Clases de color */
        .bg-purple {
            background-color: var(--bs-purple) !important;
        }

        .btn-indigo {
            --bs-btn-color: #fff;
            --bs-btn-bg: var(--bs-indigo);
            --bs-btn-border-color: var(--bs-indigo);
            --bs-btn-hover-color: #fff;
            --bs-btn-hover-bg: #5a0dd9;
            --bs-btn-hover-border-color: #550dcf;
            --bs-btn-focus-shadow-rgb: var(--bs-indigo-rgb);
            --bs-btn-active-color: #fff;
            --bs-btn-active-bg: #550dcf;
            --bs-btn-active-border-color: #500cc4;
        }

        .btn-sky-blue {
            --bs-btn-color: #000;
            --bs-btn-bg: var(--bs-sky-blue);
            --bs-btn-border-color: var(--bs-sky-blue);
            --bs-btn-hover-color: #000;
            --bs-btn-hover-bg: #3dd5f3;
            --bs-btn-hover-border-color: #25d1f2;
            --bs-btn-focus-shadow-rgb: var(--bs-sky-blue-rgb);
            --bs-btn-active-color: #000;
            --bs-btn-active-bg: #25d1f2;
            --bs-btn-active-border-color: #14ccf0;
        }

        .alert-purple {
            --bs-alert-color: var(--bs-purple);
            --bs-alert-bg: rgba(var(--bs-purple-rgb), 0.1);
            --bs-alert-border-color: rgba(var(--bs-purple-rgb), 0.3);
        }

        /* Modo oscuro */
        [data-bs-theme="dark"] {
            --bs-purple: #7d54d1;
            --bs-indigo: #7b2ff7;
            --bs-sky-blue: #0dcaf0; /* Se mantiene igual para mejor visibilidad */
        }

            [data-bs-theme="dark"] .card {
                background-color: var(--bs-dark-bg-subtle);
                border-color: var(--bs-border-color);
            }

            [data-bs-theme="dark"] .table {
                --bs-table-bg: var(--bs-dark-bg-subtle);
                --bs-table-striped-bg: var(--bs-dark-bg-subtle);
                --bs-table-hover-bg: var(--bs-dark-border-color);
                color: var(--bs-body-color);
            }

            [data-bs-theme="dark"] .table-hover > tbody > tr:hover {
                --bs-table-accent-bg: var(--bs-dark-border-color);
            }

        /* Estilo de botones */
        .btn-group .btn {
            margin-right: 0.3rem;
            border-radius: 0.25rem !important;
            min-width: 100px; /* Ancho mínimo para consistencia */
        }

            .btn-group .btn:last-child {
                margin-right: 0;
            }
    </style>
}